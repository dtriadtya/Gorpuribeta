(()=>{var e={};e.id=681,e.ids=[681],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},57310:e=>{"use strict";e.exports=require("url")},62237:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>g,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>o});var s=a(67096),r=a(16132),l=a(37284),n=a.n(l),i=a(32564),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);a.d(t,d);let o=["",{children:["schedule",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,24991)),"C:\\Projects\\backup 07-11-2025 4.11\\gorpuribeta-main\\app\\schedule\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,29925)),"C:\\Projects\\backup 07-11-2025 4.11\\gorpuribeta-main\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9291,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Projects\\backup 07-11-2025 4.11\\gorpuribeta-main\\app\\schedule\\page.tsx"],m="/schedule/page",g={require:a,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/schedule/page",pathname:"/schedule",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},79066:(e,t,a)=>{Promise.resolve().then(a.bind(a,48134))},48134:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>SchedulePage});var s=a(30784),r=a(9885),l=a(57114),n=a(79803),i=a(517),d=a(37631),o=a(11440),c=a.n(o),m=a(19300);function SchedulePage(){let e=(0,l.useRouter)(),t=(0,l.useSearchParams)(),a=t.get("fieldId"),[o,g]=(0,r.useState)(null),[x,u]=(0,r.useState)(""),[h,p]=(0,r.useState)([]),[b,f]=(0,r.useState)([]),[j,y]=(0,r.useState)(!0),[v,N]=(0,r.useState)(new Date),[w,k]=(0,r.useState)(!0),formatDate=e=>{let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${a}-${s}`},parseDateString=e=>{let[t,a,s]=e.split("-").map(Number);return new Date(t,a-1,s)},isToday=e=>e.toDateString()===new Date().toDateString(),isPast=e=>{let t=new Date;return t.setHours(0,0,0,0),e<t};(0,r.useEffect)(()=>{if(!a){e.push("/fields");return}fetchFieldData()},[a]);let fetchFieldData=async()=>{try{let t=await fetch(`/api/v1/fields?id=${a}`);if(!t.ok){e.push("/fields");return}let s=await t.json();g(s.field),await fetchScheduleData(s.field.id)}catch(t){console.error(t),e.push("/fields")}finally{y(!1)}},fetchScheduleData=async e=>{try{let t=await fetch(`/api/schedule?fieldId=${e}&t=${Date.now()}`);if(t.ok){let e=await t.json();f(e.schedule)}}catch(e){console.error(e)}};(0,r.useEffect)(()=>{if(!o)return;let e=setInterval(()=>{fetchScheduleData(o.id)},2e3);return()=>clearInterval(e)},[o]);let handleDateSelect=e=>{!e||isPast(e)||(u(formatDate(e)),p([]),k(!1))},getTimeSlotsForDate=e=>{let t=formatDate(e),a=b.find(e=>e.date===t),s=[];for(let t=8;t<22;t++){let r=`${t.toString().padStart(2,"0")}:00`,l=a?.timeSlots.find(e=>e.time===r);if(l)s.push(l);else{let a=isPast(e)&&t<new Date().getHours();s.push({time:r,available:!a,price:o?.price_per_hour??0,status:a?"booked":"available"})}}return s},handleTimeSlotClick=e=>{let t=getTimeSlotsForDate(parseDateString(x)),a=t.find(t=>t.time===e);if(a?.status==="member"){m.Z.fire({icon:"info",title:"Slot Member Reguler",html:`
          <div class="text-left">
            <p class="mb-2"><strong>Slot ini digunakan oleh member reguler:</strong></p>
            <p class="mb-1">ðŸ‘¤ <strong>Nama:</strong> ${a.memberInfo?.name}</p>
            <p class="mb-1">ðŸ“ž <strong>Kontak:</strong> ${a.memberInfo?.contactName}</p>
            <p class="mt-3 text-sm text-gray-600">Slot ini tidak tersedia untuk booking umum.</p>
          </div>
        `,confirmButtonColor:"#2563eb"});return}if(0===h.length){p([e]);return}if(h.includes(e)){p([]);return}let s=getTimeSlotsForDate(parseDateString(x)),r=h[0],l=s.findIndex(e=>e.time===r),n=s.findIndex(t=>t.time===e);if(-1===l||-1===n)return;let i=Math.min(l,n),d=Math.max(l,n),o=[];for(let e=i;e<=d;e++){if(!s[e].available)return;o.push(s[e].time)}p(o)},calculateTotalPrice=()=>o&&0!==h.length?h.length*o.price_per_hour:0;if(j)return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Memuat jadwal..."})]})});if(!o)return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Lapangan tidak ditemukan"}),s.jsx(c(),{href:"/fields",className:"btn-primary",children:"Kembali ke Daftar Lapangan"})]})});let S=(()=>{let e=v.getFullYear(),t=v.getMonth(),a=new Date(e,t,1),s=new Date(e,t+1,0),r=a.getDay(),l=s.getDate(),n=Array(r).fill(null);for(let a=1;a<=l;a++)n.push(new Date(e,t,a));return n})();return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:()=>e.push("/fields"),className:"p-2 hover:bg-gray-100 rounded-lg",children:s.jsx(n.Z,{className:"w-5 h-5 text-gray-600"})}),s.jsx("div",{children:s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:o.name})})]}),(0,s.jsxs)("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Harga per jam"}),s.jsx("p",{className:"text-lg font-semibold text-gray-900",children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(o.price_per_hour)})]})]})})}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsx("div",{className:"mb-6 bg-yellow-50 border border-yellow-300 rounded-xl p-4 shadow-sm",children:(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0 text-yellow-500 mt-0.5",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",viewBox:"0 0 16 16",children:[s.jsx("path",{d:"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"}),s.jsx("path",{d:"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"})]})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("p",{className:"text-sm text-yellow-900 leading-relaxed",children:[s.jsx("span",{className:"font-semibold",children:"Peringatan:"})," Pastikan Anda sudah membaca",s.jsx("span",{className:"font-semibold",children:" Ketentuan & Rules Booking "}),"sebelum melakukan reservasi."]}),s.jsx("div",{className:"mt-3",children:(0,s.jsxs)(c(),{href:"/information",className:"inline-flex items-center px-4 py-2 bg-yellow-400 hover:bg-yellow-500 text-yellow-900 text-sm font-semibold rounded-lg transition-colors shadow-sm",children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Baca Ketentuan & Rules"]})})]})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsx("div",{className:"lg:col-span-2",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:w?"Pilih Tanggal":"Pilih Waktu"}),s.jsx("div",{className:"flex items-center space-x-2",children:!w&&(0,s.jsxs)("button",{onClick:()=>k(!0),className:"px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200",children:[s.jsx(i.Z,{className:"w-4 h-4 inline mr-1"})," Ubah Tanggal"]})})]}),w&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("button",{onClick:()=>{let e=new Date(v);e.setMonth(e.getMonth()-1);let t=new Date;e.getFullYear()<t.getFullYear()||e.getFullYear()===t.getFullYear()&&e.getMonth()<t.getMonth()||N(e)},className:"p-2 hover:bg-gray-100 rounded-lg",children:s.jsx(n.Z,{className:"w-5 h-5"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:v.toLocaleDateString("id-ID",{month:"long",year:"numeric"})}),s.jsx("button",{onClick:()=>{let e=new Date(v);e.setMonth(e.getMonth()+1),N(e)},className:"p-2 hover:bg-gray-100 rounded-lg",children:s.jsx(d.Z,{className:"w-5 h-5"})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-7 gap-2",children:[["Min","Sen","Sel","Rab","Kam","Jum","Sab"].map(e=>s.jsx("div",{className:"text-center text-sm font-medium text-gray-500 py-2",children:e},e)),S.map((e,t)=>{if(!e)return s.jsx("div",{className:"p-3"},`empty-${t}`);let a=formatDate(e),r=b.find(e=>e.date===a),l=r?r.timeSlots.filter(e=>"booked"===e.status||"member"===e.status).length:0,n=l>=14,i=isPast(e)||n,d=x===a,o=isToday(e);return(0,s.jsxs)("button",{onClick:()=>handleDateSelect(e),disabled:i,className:`
        p-3 rounded-lg text-sm font-medium transition-all
        ${d?"bg-primary-600 text-white ring-2 ring-primary-300":n?"bg-red-100 text-red-500 cursor-not-allowed border border-red-200":i?"bg-gray-100 text-gray-300 cursor-not-allowed":o?"bg-blue-50 text-blue-600 border-2 border-blue-300 hover:bg-blue-100":"bg-gray-50 text-gray-700 hover:bg-gray-100 hover:ring-2 hover:ring-gray-200"}
      `,children:[s.jsx("div",{children:e.getDate()}),n&&s.jsx("div",{className:"text-[10px] text-red-500 font-medium mt-1"})]},t)})]}),s.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:(0,s.jsxs)("p",{className:"text-sm text-blue-800",children:["\uD83D\uDCA1 ",s.jsx("strong",{children:"Tips:"})," Pilih tanggal pada kalender untuk melihat slot waktu yang tersedia"]})})]}),!w&&x&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["Pilih Waktu - ",parseDateString(x).toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Klik waktu mulai, lalu klik waktu akhir untuk memilih range. Contoh ingin memesan 2 jam maka klik 08:00 dan 09:00 dst (Notes: Klik refresh agar jadawlnya ter-update)."}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 text-xs",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"w-3 h-3 bg-gray-50 border border-gray-200 rounded"}),s.jsx("span",{className:"text-gray-600",children:"Tersedia"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"w-3 h-3 bg-primary-600 rounded"}),s.jsx("span",{className:"text-gray-600",children:"Terpilih"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"w-3 h-3 bg-red-100 border border-red-200 rounded"}),s.jsx("span",{className:"text-gray-600",children:"Terbooking"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"w-3 h-3 bg-orange-100 border border-orange-300 rounded"}),s.jsx("span",{className:"text-gray-600",children:"Member"})]})]})]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3",children:getTimeSlotsForDate(parseDateString(x)).map(e=>{let t=h.includes(e.time),a=h[0]===e.time,r=h[h.length-1]===e.time,l=h.length>1&&t&&!a&&!r;return(0,s.jsxs)("button",{onClick:()=>handleTimeSlotClick(e.time),disabled:!e.available||"booked"===e.status||"member"===e.status,className:`
                            p-2 sm:p-3 rounded-lg text-[11px] sm:text-sm font-medium transition-colors
                            ${t?"bg-primary-600 text-white":"booked"===e.status?"bg-red-100 text-red-600 border border-red-200 cursor-not-allowed":"member"===e.status?"bg-orange-100 text-orange-700 border border-orange-300 cursor-pointer hover:bg-orange-200":e.available?"bg-gray-50 text-gray-700 hover:bg-gray-100 border border-gray-200":"bg-gray-100 text-gray-400 cursor-not-allowed"}
                            ${a&&h.length>1?"rounded-l-lg":""}
                            ${r&&h.length>1?"rounded-r-lg":""}
                            ${l?"rounded-none":""}
                          `,children:[(0,s.jsxs)("div",{children:[e.time," - ",String(parseInt(e.time.split(":")[0])+1).padStart(2,"0"),":00"]}),s.jsx("div",{className:"text-[9px] sm:text-xs opacity-75 mt-0.5",children:"booked"===e.status?"Terbooking":"member"===e.status?"Member":"Tersedia"})]},e.time)})})]})]})}),s.jsx("div",{className:"lg:col-span-1",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 sticky top-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Ringkasan"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Lapangan"}),s.jsx("p",{className:"font-medium text-gray-900",children:o.name})]}),x&&(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Tanggal"}),s.jsx("p",{className:"font-medium text-gray-900",children:parseDateString(x).toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})]}),h.length>0&&(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Waktu"}),(0,s.jsxs)("p",{className:"font-medium text-gray-900",children:[h[0]," - ",String(parseInt(h[h.length-1].split(":")[0])+1).padStart(2,"0"),":00"]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[h.length," jam"]})]}),s.jsx("div",{className:"border-t pt-4",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Total"}),s.jsx("span",{className:"text-lg font-semibold text-gray-900",children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(calculateTotalPrice())})]})}),s.jsx("button",{onClick:()=>{if(!x||0===h.length)return;try{let t=localStorage.getItem("token"),a=localStorage.getItem("user");if(!t||!a){m.Z.fire({icon:"warning",title:"Perlu Login",text:"Anda harus login terlebih dahulu untuk melanjutkan reservasi.",showCancelButton:!0,confirmButtonText:"Login",cancelButtonText:"Batal",confirmButtonColor:"#2563eb"}).then(t=>{t.isConfirmed&&e.push("/login")});return}}catch(e){console.error("Error checking auth state",e)}let t=parseInt(h[0].split(":")[0]),s=parseInt(h[h.length-1].split(":")[0])+1,r=new URLSearchParams({fieldId:a,date:x,startTime:`${t.toString().padStart(2,"0")}:00`,endTime:`${s.toString().padStart(2,"0")}:00`,totalPrice:calculateTotalPrice().toString()});e.push(`/booking?${r.toString()}`)},disabled:!x||0===h.length,className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Lanjutkan ke Reservasi"})]})]})})]})]})]})}},24991:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>n,__esModule:()=>l,default:()=>d});var s=a(95153);let r=(0,s.createProxy)(String.raw`C:\Projects\backup 07-11-2025 4.11\gorpuribeta-main\app\schedule\page.tsx`),{__esModule:l,$$typeof:n}=r,i=r.default,d=i}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[2006,2246,6044,6897],()=>__webpack_exec__(62237));module.exports=a})();
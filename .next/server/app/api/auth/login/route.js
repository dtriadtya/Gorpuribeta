"use strict";(()=>{var e={};e.id=8873,e.ids=[8873],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},19876:(e,r,a)=>{a.r(r),a.d(r,{headerHooks:()=>g,originalPathname:()=>v,requestAsyncStorage:()=>m,routeModule:()=>_,serverHooks:()=>h,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>k});var s={};a.r(s),a.d(s,{POST:()=>POST});var t=a(10884),i=a(16132),u=a(95798),o=a(62421),n=a.n(o),l=a(96721),p=a.n(l),d=a(15204);async function POST(e){try{let r=await e.json(),{email:a,password:s}=r;if(!a||!s)return u.Z.json({error:"Email dan password harus diisi"},{status:400});let t=await d._.user.findUnique({where:{email_user:a},select:{id_user:!0,nama_user:!0,email_user:!0,phone_user:!0,password:!0,role:!0,isActive:!0,user_dibuat_pada:!0,user_diupdate_pada:!0}});if(!t)return u.Z.json({error:"Email atau password salah"},{status:401});let i=await n().compare(s,t.password);if(!i)return u.Z.json({error:"Email atau password salah"},{status:401});if(!t.isActive)return u.Z.json({error:"Akun Anda tidak aktif. Silakan hubungi administrator."},{status:403});let o=p().sign({userId:t.id_user,email:t.email_user,role:t.role},process.env.JWT_SECRET||"fallback-secret",{expiresIn:"7d"}),{password:l,..._}=t,m={id:t.id_user,id_user:t.id_user,name:t.nama_user,nama_user:t.nama_user,email:t.email_user,email_user:t.email_user,phone:t.phone_user,phone_user:t.phone_user,role:t.role,isActive:t.isActive,createdAt:t.user_dibuat_pada.toISOString(),updatedAt:t.user_diupdate_pada.toISOString()},c=u.Z.json({message:"Login berhasil",user:m,token:o});return c.cookies.set({name:"token",value:o,httpOnly:!0,secure:!0,sameSite:"lax",path:"/",maxAge:604800}),c}catch(e){return console.error("Error logging in user:",e),u.Z.json({error:"Terjadi kesalahan server"},{status:500})}}let _=new t.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"C:\\Projects\\backup 07-11-2025 4.11\\gorpuribeta-main\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:c,serverHooks:h,headerHooks:g,staticGenerationBailout:k}=_,v="/api/auth/login/route"},15204:(e,r,a)=>{a.d(r,{_:()=>t});var s=a(53524);let t=global.prisma||new s.PrismaClient({log:["error"]})}};var r=require("../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),a=r.X(0,[2006,8107,6721,2421],()=>__webpack_exec__(19876));module.exports=a})();
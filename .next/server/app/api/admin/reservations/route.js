"use strict";(()=>{var a={};a.id=7516,a.ids=[7516],a.modules={53524:a=>{a.exports=require("@prisma/client")},30517:a=>{a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:a=>{a.exports=require("buffer")},6113:a=>{a.exports=require("crypto")},12781:a=>{a.exports=require("stream")},73837:a=>{a.exports=require("util")},92788:(a,e,n)=>{n.r(e),n.d(e,{headerHooks:()=>m,originalPathname:()=>c,requestAsyncStorage:()=>_,routeModule:()=>u,serverHooks:()=>p,staticGenerationAsyncStorage:()=>o,staticGenerationBailout:()=>v});var r={};n.r(r),n.d(r,{GET:()=>GET});var t=n(10884),i=n(16132),s=n(95798),l=n(15204),d=n(8192);async function GET(a){try{let e=(0,d.Ym)(a);if(!e)return s.Z.json({error:"Unauthorized"},{status:401});if("ADMIN"!==e.role)return s.Z.json({error:"Forbidden - Admin access required"},{status:403});let n=await l._.reservation.findMany({include:{user:{select:{id_user:!0,nama_user:!0,email_user:!0,phone_user:!0}},lapangan:{select:{id_lapangan:!0,nama_lapangan:!0}},validator_lunas:{select:{id_user:!0,nama_user:!0,email_user:!0}},validator_dp:{select:{id_user:!0,nama_user:!0,email_user:!0}},validator_pelunasan:{select:{id_user:!0,nama_user:!0,email_user:!0}}},orderBy:[{tanggal_reservasi:"desc"},{jam_mulai_reservasi:"desc"}]}),r=n.map(a=>({id:a.id_reservasi,user_id:a.id_user,field_id:a.id_lapangan,field_name:a.lapangan?.nama_lapangan,reservation_date:a.tanggal_reservasi.toISOString(),start_time:a.jam_mulai_reservasi,end_time:a.jam_selesai_reservasi,total_price:Number(a.total_harga),status:a.status_reservasi,payment_status:a.status_pembayaran,payment_type:a.tipe_pembayaran??null,payment_amount:null!=a.paymentAmount?Number(a.paymentAmount):null,payment_proof:a.bukti_lunas,dp_proof:a.bukti_dp,pelunasan_proof:a.bukti_pelunasan,payment_notes:a.paymentNotes,dp_sender_account_name:a.nama_rekening_dp,pelunasan_sender_account_name:a.nama_rekening_pelunasan,dpSenderAccountName:a.nama_rekening_dp,pelunasanSenderAccountName:a.nama_rekening_pelunasan,notes:a.notes,payment_validated_by:a.validasi_lunas_oleh??null,payment_validated_at:a.paymentValidatedAt?a.paymentValidatedAt.toISOString():null,payment_validated_admin:a.validator_lunas?{id:a.validator_lunas.id_user,name:a.validator_lunas.nama_user,email:a.validator_lunas.email_user}:null,dp_validated_by:a.validasi_dp_oleh??null,dp_validated_at:a.dpValidatedAt?a.dpValidatedAt.toISOString():null,dp_validated_admin:a.validator_dp?{id:a.validator_dp.id_user,name:a.validator_dp.nama_user,email:a.validator_dp.email_user}:null,pelunasan_validated_by:a.validasi_pelunasan_oleh??null,pelunasan_validated_at:a.pelunasanValidatedAt?a.pelunasanValidatedAt.toISOString():null,pelunasan_validated_admin:a.validator_pelunasan?{id:a.validator_pelunasan.id_user,name:a.validator_pelunasan.nama_user,email:a.validator_pelunasan.email_user}:null,created_at:a.reservasi_dibuat_pada.toISOString(),updated_at:a.reservasi_diupdate_pada.toISOString(),user:{id:a.user.id_user,name:a.user.nama_user,email:a.user.email_user,phone:a.user.phone_user},field:{id:a.lapangan.id_lapangan,name:a.lapangan.nama_lapangan}}));return s.Z.json({reservations:r})}catch(a){return console.error("Error fetching admin reservations:",a),s.Z.json({error:"Internal server error"},{status:500})}}let u=new t.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/reservations/route",pathname:"/api/admin/reservations",filename:"route",bundlePath:"app/api/admin/reservations/route"},resolvedPagePath:"C:\\Projects\\backup 07-11-2025 4.11\\gorpuribeta-main\\app\\api\\admin\\reservations\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:_,staticGenerationAsyncStorage:o,serverHooks:p,headerHooks:m,staticGenerationBailout:v}=u,c="/api/admin/reservations/route"}};var e=require("../../../../webpack-runtime.js");e.C(a);var __webpack_exec__=a=>e(e.s=a),n=e.X(0,[2006,8107,6721,390],()=>__webpack_exec__(92788));module.exports=n})();
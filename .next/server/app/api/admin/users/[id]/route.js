"use strict";(()=>{var e={};e.id=1317,e.ids=[1317],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},231:(e,r,s)=>{s.r(r),s.d(r,{headerHooks:()=>f,originalPathname:()=>w,requestAsyncStorage:()=>_,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>h});var t={};s.r(t),s.d(t,{DELETE:()=>DELETE,GET:()=>GET,PUT:()=>PUT});var a=s(10884),u=s(16132),n=s(95798),i=s(15204),o=s(62421),d=s.n(o),l=s(8192);async function GET(e,{params:r}){try{let s=(0,l.Ym)(e);if(!s)return n.Z.json({error:"Unauthorized"},{status:401});if("ADMIN"!==s.role)return n.Z.json({error:"Forbidden - Admin access required"},{status:403});let{id:t}=r,a=await i._.user.findUnique({where:{id_user:parseInt(t)},select:{id_user:!0,nama_user:!0,email_user:!0,phone_user:!0,role:!0,user_dibuat_pada:!0,user_diupdate_pada:!0,_count:{select:{reservasi:!0}}}});if(!a)return n.Z.json({error:"User not found"},{status:404});let u={id:a.id_user,name:a.nama_user,email:a.email_user,phone:a.phone_user,role:a.role,createdAt:a.user_dibuat_pada.toISOString(),updatedAt:a.user_diupdate_pada.toISOString(),_count:a._count};return n.Z.json({user:u})}catch(e){return console.error("Error fetching user:",e),n.Z.json({error:"Internal server error"},{status:500})}}async function PUT(e,{params:r}){try{let s=(0,l.Ym)(e);if(!s)return n.Z.json({error:"Unauthorized"},{status:401});if("ADMIN"!==s.role)return n.Z.json({error:"Forbidden - Admin access required"},{status:403});let{id:t}=r,a=await e.json(),{name:u,email:o,phone:p,role:_,password:c}=a,m=await i._.user.findUnique({where:{id_user:parseInt(t)}});if(!m)return n.Z.json({error:"User not found"},{status:404});if(o&&o!==m.email_user){let e=await i._.user.findUnique({where:{email_user:o}});if(e)return n.Z.json({error:"Email already exists"},{status:409})}let f={...u&&{nama_user:u},...o&&{email_user:o},...void 0!==p&&{phone_user:p||null},..._&&{role:_}};if(c&&""!==c.trim()){let e=await d().hash(c,12);f.password=e,console.log(`âœ… Password updated for user ID: ${t}`)}let h=await i._.user.update({where:{id_user:parseInt(t)},data:f,select:{id_user:!0,nama_user:!0,email_user:!0,phone_user:!0,role:!0,user_dibuat_pada:!0,user_diupdate_pada:!0}}),w={id:h.id_user,name:h.nama_user,email:h.email_user,phone:h.phone_user,role:h.role,createdAt:h.user_dibuat_pada.toISOString(),updatedAt:h.user_diupdate_pada.toISOString()};return n.Z.json({message:"User updated successfully",user:w})}catch(e){return console.error("Error updating user:",e),n.Z.json({error:"Internal server error"},{status:500})}}async function DELETE(e,{params:r}){try{let{id:e}=r,s=await i._.user.findUnique({where:{id_user:parseInt(e)}});if(!s)return n.Z.json({error:"User not found"},{status:404});let t=await i._.reservation.count({where:{id_user:parseInt(e)}});if(t>0)return n.Z.json({error:"Cannot delete user with existing reservations"},{status:400});return await i._.user.delete({where:{id_user:parseInt(e)}}),n.Z.json({message:"User deleted successfully"})}catch(e){return console.error("Error deleting user:",e),n.Z.json({error:"Internal server error"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:u.x.APP_ROUTE,page:"/api/admin/users/[id]/route",pathname:"/api/admin/users/[id]",filename:"route",bundlePath:"app/api/admin/users/[id]/route"},resolvedPagePath:"C:\\Projects\\backup 07-11-2025 4.11\\gorpuribeta-main\\app\\api\\admin\\users\\[id]\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:_,staticGenerationAsyncStorage:c,serverHooks:m,headerHooks:f,staticGenerationBailout:h}=p,w="/api/admin/users/[id]/route"}};var r=require("../../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),s=r.X(0,[2006,8107,6721,2421,390],()=>__webpack_exec__(231));module.exports=s})();
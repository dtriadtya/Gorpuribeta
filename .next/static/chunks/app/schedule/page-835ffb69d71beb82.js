(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[681],{5531:function(e,t,a){"use strict";a.d(t,{Z:function(){return createLucideIcon}});var r=a(2265);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),toCamelCase=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),toPascalCase=e=>{let t=toCamelCase(e);return t.charAt(0).toUpperCase()+t.slice(1)},mergeClasses=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim(),hasA11yProp=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:n="",children:i,iconNode:c,...o},d)=>(0,r.createElement)("svg",{ref:d,...s,width:t,height:t,stroke:e,strokeWidth:l?24*Number(a)/Number(t):a,className:mergeClasses("lucide",n),...!i&&!hasA11yProp(o)&&{"aria-hidden":"true"},...o},[...c.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(i)?i:[i]])),createLucideIcon=(e,t)=>{let a=(0,r.forwardRef)(({className:a,...s},n)=>(0,r.createElement)(l,{ref:n,iconNode:t,className:mergeClasses(`lucide-${toKebabCase(toPascalCase(e))}`,`lucide-${e}`,a),...s}));return a.displayName=toPascalCase(e),a}},3067:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(5531);let s=(0,r.Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8291:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(5531);let s=(0,r.Z)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},8203:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(5531);let s=(0,r.Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},7728:function(e,t,a){Promise.resolve().then(a.bind(a,8892))},8892:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return SchedulePage}});var r=a(7437),s=a(2265),l=a(4033),n=a(3067),i=a(8203),c=a(8291),o=a(1396),d=a.n(o),m=a(6820),h=a.n(m);function SchedulePage(){let e=(0,l.useRouter)(),t=(0,l.useSearchParams)(),a=t.get("fieldId"),[o,m]=(0,s.useState)(null),[u,g]=(0,s.useState)(""),[x,p]=(0,s.useState)([]),[b,f]=(0,s.useState)([]),[y,j]=(0,s.useState)(!0),[v,N]=(0,s.useState)(new Date),[w,k]=(0,s.useState)(!0),formatDate=e=>{let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(r)},parseDateString=e=>{let[t,a,r]=e.split("-").map(Number);return new Date(t,a-1,r)},isToday=e=>e.toDateString()===new Date().toDateString(),isPast=e=>{let t=new Date;return t.setHours(0,0,0,0),e<t};(0,s.useEffect)(()=>{if(!a){e.push("/fields");return}fetchFieldData()},[a]);let fetchFieldData=async()=>{try{let t=await fetch("/api/v1/fields?id=".concat(a));if(!t.ok){e.push("/fields");return}let r=await t.json();m(r.field),await fetchScheduleData(r.field.id)}catch(t){console.error(t),e.push("/fields")}finally{j(!1)}},fetchScheduleData=async e=>{try{let t=await fetch("/api/schedule?fieldId=".concat(e,"&t=").concat(Date.now()));if(t.ok){let e=await t.json();f(e.schedule)}}catch(e){console.error(e)}};(0,s.useEffect)(()=>{if(!o)return;let e=setInterval(()=>{fetchScheduleData(o.id)},2e3);return()=>clearInterval(e)},[o]);let handleDateSelect=e=>{!e||isPast(e)||(g(formatDate(e)),p([]),k(!1))},getTimeSlotsForDate=e=>{let t=formatDate(e),a=b.find(e=>e.date===t),r=[];for(let t=8;t<22;t++){let l="".concat(t.toString().padStart(2,"0"),":00"),n=null==a?void 0:a.timeSlots.find(e=>e.time===l);if(n)r.push(n);else{var s;let a=isPast(e)&&t<new Date().getHours();r.push({time:l,available:!a,price:null!==(s=null==o?void 0:o.price_per_hour)&&void 0!==s?s:0,status:a?"booked":"available"})}}return r},handleTimeSlotClick=e=>{let t=getTimeSlotsForDate(parseDateString(u)),a=t.find(t=>t.time===e);if((null==a?void 0:a.status)==="member"){var r,s;h().fire({icon:"info",title:"Slot Member Reguler",html:'\n          <div class="text-left">\n            <p class="mb-2"><strong>Slot ini digunakan oleh member reguler:</strong></p>\n            <p class="mb-1">\uD83D\uDC64 <strong>Nama:</strong> '.concat(null===(r=a.memberInfo)||void 0===r?void 0:r.name,'</p>\n            <p class="mb-1">\uD83D\uDCDE <strong>Kontak:</strong> ').concat(null===(s=a.memberInfo)||void 0===s?void 0:s.contactName,'</p>\n            <p class="mt-3 text-sm text-gray-600">Slot ini tidak tersedia untuk booking umum.</p>\n          </div>\n        '),confirmButtonColor:"#2563eb"});return}if(0===x.length){p([e]);return}if(x.includes(e)){p([]);return}let l=getTimeSlotsForDate(parseDateString(u)),n=x[0],i=l.findIndex(e=>e.time===n),c=l.findIndex(t=>t.time===e);if(-1===i||-1===c)return;let o=Math.min(i,c),d=Math.max(i,c),m=[];for(let e=o;e<=d;e++){if(!l[e].available)return;m.push(l[e].time)}p(m)},calculateTotalPrice=()=>o&&0!==x.length?x.length*o.price_per_hour:0;if(y)return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Memuat jadwal..."})]})});if(!o)return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Lapangan tidak ditemukan"}),(0,r.jsx)(d(),{href:"/fields",className:"btn-primary",children:"Kembali ke Daftar Lapangan"})]})});let D=(()=>{let e=v.getFullYear(),t=v.getMonth(),a=new Date(e,t,1),r=new Date(e,t+1,0),s=a.getDay(),l=r.getDate(),n=Array(s).fill(null);for(let a=1;a<=l;a++)n.push(new Date(e,t,a));return n})();return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("div",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:()=>e.push("/fields"),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,r.jsx)(n.Z,{className:"w-5 h-5 text-gray-600"})}),(0,r.jsx)("div",{children:(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:o.name})})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Harga per jam"}),(0,r.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(o.price_per_hour)})]})]})})}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsx)("div",{className:"mb-6 bg-yellow-50 border border-yellow-300 rounded-xl p-4 shadow-sm",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0 text-yellow-500 mt-0.5",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",viewBox:"0 0 16 16",children:[(0,r.jsx)("path",{d:"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"}),(0,r.jsx)("path",{d:"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"})]})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("p",{className:"text-sm text-yellow-900 leading-relaxed",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Peringatan:"})," Pastikan Anda sudah membaca",(0,r.jsx)("span",{className:"font-semibold",children:" Ketentuan & Rules Booking "}),"sebelum melakukan reservasi."]}),(0,r.jsx)("div",{className:"mt-3",children:(0,r.jsxs)(d(),{href:"/information",className:"inline-flex items-center px-4 py-2 bg-yellow-400 hover:bg-yellow-500 text-yellow-900 text-sm font-semibold rounded-lg transition-colors shadow-sm",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Baca Ketentuan & Rules"]})})]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:w?"Pilih Tanggal":"Pilih Waktu"}),(0,r.jsx)("div",{className:"flex items-center space-x-2",children:!w&&(0,r.jsxs)("button",{onClick:()=>k(!0),className:"px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200",children:[(0,r.jsx)(i.Z,{className:"w-4 h-4 inline mr-1"})," Ubah Tanggal"]})})]}),w&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("button",{onClick:()=>{let e=new Date(v);e.setMonth(e.getMonth()-1);let t=new Date;e.getFullYear()<t.getFullYear()||e.getFullYear()===t.getFullYear()&&e.getMonth()<t.getMonth()||N(e)},className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,r.jsx)(n.Z,{className:"w-5 h-5"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:v.toLocaleDateString("id-ID",{month:"long",year:"numeric"})}),(0,r.jsx)("button",{onClick:()=>{let e=new Date(v);e.setMonth(e.getMonth()+1),N(e)},className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,r.jsx)(c.Z,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-7 gap-2",children:[["Min","Sen","Sel","Rab","Kam","Jum","Sab"].map(e=>(0,r.jsx)("div",{className:"text-center text-sm font-medium text-gray-500 py-2",children:e},e)),D.map((e,t)=>{if(!e)return(0,r.jsx)("div",{className:"p-3"},"empty-".concat(t));let a=formatDate(e),s=b.find(e=>e.date===a),l=s?s.timeSlots.filter(e=>"booked"===e.status||"member"===e.status).length:0,n=l>=14,i=isPast(e)||n,c=u===a,o=isToday(e);return(0,r.jsxs)("button",{onClick:()=>handleDateSelect(e),disabled:i,className:"\n        p-3 rounded-lg text-sm font-medium transition-all\n        ".concat(c?"bg-primary-600 text-white ring-2 ring-primary-300":n?"bg-red-100 text-red-500 cursor-not-allowed border border-red-200":i?"bg-gray-100 text-gray-300 cursor-not-allowed":o?"bg-blue-50 text-blue-600 border-2 border-blue-300 hover:bg-blue-100":"bg-gray-50 text-gray-700 hover:bg-gray-100 hover:ring-2 hover:ring-gray-200","\n      "),children:[(0,r.jsx)("div",{children:e.getDate()}),n&&(0,r.jsx)("div",{className:"text-[10px] text-red-500 font-medium mt-1"})]},t)})]}),(0,r.jsx)("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:(0,r.jsxs)("p",{className:"text-sm text-blue-800",children:["\uD83D\uDCA1 ",(0,r.jsx)("strong",{children:"Tips:"})," Pilih tanggal pada kalender untuk melihat slot waktu yang tersedia"]})})]}),!w&&u&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["Pilih Waktu - ",parseDateString(u).toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Klik waktu mulai, lalu klik waktu akhir untuk memilih range. Contoh ingin memesan 2 jam maka klik 08:00 dan 09:00 dst (Notes: Klik refresh agar jadawlnya ter-update)."}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-xs",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-gray-50 border border-gray-200 rounded"}),(0,r.jsx)("span",{className:"text-gray-600",children:"Tersedia"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-primary-600 rounded"}),(0,r.jsx)("span",{className:"text-gray-600",children:"Terpilih"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-red-100 border border-red-200 rounded"}),(0,r.jsx)("span",{className:"text-gray-600",children:"Terbooking"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-orange-100 border border-orange-300 rounded"}),(0,r.jsx)("span",{className:"text-gray-600",children:"Member"})]})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3",children:getTimeSlotsForDate(parseDateString(u)).map(e=>{let t=x.includes(e.time),a=x[0]===e.time,s=x[x.length-1]===e.time,l=x.length>1&&t&&!a&&!s;return(0,r.jsxs)("button",{onClick:()=>handleTimeSlotClick(e.time),disabled:!e.available||"booked"===e.status||"member"===e.status,className:"\n                            p-2 sm:p-3 rounded-lg text-[11px] sm:text-sm font-medium transition-colors\n                            ".concat(t?"bg-primary-600 text-white":"booked"===e.status?"bg-red-100 text-red-600 border border-red-200 cursor-not-allowed":"member"===e.status?"bg-orange-100 text-orange-700 border border-orange-300 cursor-pointer hover:bg-orange-200":e.available?"bg-gray-50 text-gray-700 hover:bg-gray-100 border border-gray-200":"bg-gray-100 text-gray-400 cursor-not-allowed","\n                            ").concat(a&&x.length>1?"rounded-l-lg":"","\n                            ").concat(s&&x.length>1?"rounded-r-lg":"","\n                            ").concat(l?"rounded-none":"","\n                          "),children:[(0,r.jsxs)("div",{children:[e.time," - ",String(parseInt(e.time.split(":")[0])+1).padStart(2,"0"),":00"]}),(0,r.jsx)("div",{className:"text-[9px] sm:text-xs opacity-75 mt-0.5",children:"booked"===e.status?"Terbooking":"member"===e.status?"Member":"Tersedia"})]},e.time)})})]})]})}),(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 sticky top-8",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Ringkasan"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Lapangan"}),(0,r.jsx)("p",{className:"font-medium text-gray-900",children:o.name})]}),u&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Tanggal"}),(0,r.jsx)("p",{className:"font-medium text-gray-900",children:parseDateString(u).toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})]}),x.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Waktu"}),(0,r.jsxs)("p",{className:"font-medium text-gray-900",children:[x[0]," - ",String(parseInt(x[x.length-1].split(":")[0])+1).padStart(2,"0"),":00"]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[x.length," jam"]})]}),(0,r.jsx)("div",{className:"border-t pt-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Total"}),(0,r.jsx)("span",{className:"text-lg font-semibold text-gray-900",children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(calculateTotalPrice())})]})}),(0,r.jsx)("button",{onClick:()=>{if(!u||0===x.length)return;try{let t=localStorage.getItem("token"),a=localStorage.getItem("user");if(!t||!a){h().fire({icon:"warning",title:"Perlu Login",text:"Anda harus login terlebih dahulu untuk melanjutkan reservasi.",showCancelButton:!0,confirmButtonText:"Login",cancelButtonText:"Batal",confirmButtonColor:"#2563eb"}).then(t=>{t.isConfirmed&&e.push("/login")});return}}catch(e){console.error("Error checking auth state",e)}let t=parseInt(x[0].split(":")[0]),r=parseInt(x[x.length-1].split(":")[0])+1,s=new URLSearchParams({fieldId:a,date:u,startTime:"".concat(t.toString().padStart(2,"0"),":00"),endTime:"".concat(r.toString().padStart(2,"0"),":00"),totalPrice:calculateTotalPrice().toString()});e.push("/booking?".concat(s.toString()))},disabled:!u||0===x.length,className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Lanjutkan ke Reservasi"})]})]})})]})]})]})}},4033:function(e,t,a){e.exports=a(94)}},function(e){e.O(0,[461,176,971,472,744],function(){return e(e.s=7728)}),_N_E=e.O()}]);
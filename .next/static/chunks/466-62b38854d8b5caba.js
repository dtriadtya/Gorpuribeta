"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[466],{7750:function(e,a,t){t.d(a,{Z:function(){return BookingDetailModal}});var s=t(7437),n=t(2549),r=t(5367),l=t(2265),i=t(9670),o=t(6820),c=t.n(o);function PaymentValidation(e){var a,t,r,o,d,m,u;let{reservation:x,onStatusUpdate:p}=e,g=(null===(a=x.payment_notes)||void 0===a?void 0:a.toLowerCase())||"",h="CANCELLED"===x.status||"REJECTED"===x.status,y="FULL"===x.payment_type&&(x.payment_proof||x.dp_proof)||void 0,b="DP"===x.payment_type&&(x.dp_proof||x.payment_proof)||void 0,f="DP"===x.payment_type&&x.pelunasan_proof||void 0,j=!!b,N=!!f,k=!!y;console.log("Proof URLs:",{payment_type:x.payment_type,raw_payment_proof:x.payment_proof,raw_dp_proof:x.dp_proof,raw_pelunasan_proof:x.pelunasan_proof,computed_dpProofUrl:b,computed_pelunasanProofUrl:f,computed_fullProofUrl:y,dpProofAvailable:j,pelunasanProofAvailable:N,fullProofAvailable:k});let[D,v]=(0,l.useState)(!1),[P,_]=(0,l.useState)(!1),[w,E]=(0,l.useState)(!1),[T,A]=(0,l.useState)(!1),[L,S]=(0,l.useState)("DP"===x.payment_type?"dp":"full"),[B,C]=(0,l.useState)(!j),[I,U]=(0,l.useState)(!N),[R,F]=(0,l.useState)(!k),Z="pelunasan"===L?f:"dp"===L?b:y;(0,l.useEffect)(()=>{C(!b),U(!f),F(!y)},[x.id,b,f,y]);let K="flex items-center justify-center px-4 h-10 rounded-lg text-sm font-medium transition-colors",V="".concat(K," bg-red-600 text-white hover:bg-red-700 w-full"),G="flex items-center justify-center space-x-2 px-3 h-10 rounded-md text-sm font-medium bg-blue-600 text-white hover:bg-blue-700 w-full",O="flex items-center justify-center space-x-2 px-3 h-10 rounded-md text-sm font-medium bg-gray-200 text-gray-500 cursor-not-allowed w-full",handleViewProof=e=>{("dp"!==e||b)&&("pelunasan"!==e||f)&&("full"!==e||y)&&(S(e),A(!0),"dp"===e?C(!0):"pelunasan"===e?U(!0):F(!0))},J="DP"===x.payment_type,M=!!(f&&"PAID"!==x.payment_status),z=!j||B,H=!N||I,Y=!k||R,W=!!(!z&&J||!H&&J&&N||!J&&!Y),handleRejectPelunasan=async()=>{if(P)return;let e="DP"===x.payment_type?N:k,a="DP"===x.payment_type?I:R;if(!e)return;if(!a){await c().fire({icon:"info",title:"Lihat bukti terlebih dahulu",text:"Silakan lihat bukti ".concat("DP"===x.payment_type?"pelunasan":"pembayaran"," sebelum menolak."),confirmButtonText:"OK"});return}let t="FULL"===x.payment_type?"Booking akan DITOLAK dan user harus melakukan reservasi ulang dari awal.":"User harus mengunggah ulang bukti pelunasan setelah penolakan.",s=await c().fire({title:"Tolak bukti ".concat("DP"===x.payment_type?"pelunasan":"pembayaran","?"),text:t,icon:"warning",showCancelButton:!0,confirmButtonColor:"#EF4444",cancelButtonColor:"#6B7280",confirmButtonText:"Ya, tolak",cancelButtonText:"Batal"});if(!s.isConfirmed)return;let n=localStorage.getItem("token");if(!n){await c().fire({icon:"error",title:"Sesi berakhir",text:"Silakan login ulang sebagai admin untuk melanjutkan.",confirmButtonText:"OK"});return}try{_(!0);let e="FULL"===x.payment_type?"REJECT_FULL":"REJECT_PELUNASAN",a=await fetch("/api/reservations/".concat(x.id,"/payment"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({action:e,adminNotes:"Ditolak oleh admin"})});if(!a.ok){let e=await a.json();throw Error((null==e?void 0:e.error)||"Gagal menolak bukti ".concat("DP"===x.payment_type?"pelunasan":"pembayaran"))}let t="FULL"===x.payment_type?"Booking telah ditolak. User harus melakukan reservasi ulang.":"User dapat mengunggah ulang bukti pelunasan yang valid.";await c().fire({icon:"success",title:"Bukti ".concat("DP"===x.payment_type?"pelunasan":"pembayaran"," ditolak"),text:t,confirmButtonText:"OK"}),p(x.id,e)}catch(e){console.error("Error rejecting payment proof:",e),await c().fire({icon:"error",title:"Gagal menolak bukti",text:e instanceof Error?e.message:"Terjadi kesalahan saat menolak bukti ".concat("DP"===x.payment_type?"pelunasan":"pembayaran","."),confirmButtonText:"OK"})}finally{_(!1)}},handleRejectDp=async()=>{if(w||!j)return;if(!B){await c().fire({icon:"info",title:"Lihat bukti terlebih dahulu",text:"Silakan lihat bukti DP sebelum menolak.",confirmButtonText:"OK"});return}let e=await c().fire({title:"Tolak bukti DP?",text:"User harus mengunggah ulang bukti DP setelah penolakan.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#EF4444",cancelButtonColor:"#6B7280",confirmButtonText:"Ya, tolak",cancelButtonText:"Batal"});if(!e.isConfirmed)return;let a=localStorage.getItem("token");if(!a){await c().fire({icon:"error",title:"Sesi berakhir",text:"Silakan login ulang sebagai admin untuk melanjutkan.",confirmButtonText:"OK"});return}try{E(!0);let e=await fetch("/api/reservations/".concat(x.id,"/payment"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({action:"REJECT_DP",adminNotes:"Ditolak oleh admin"})});if(!e.ok){let a=await e.json();throw Error((null==a?void 0:a.error)||"Gagal menolak bukti DP")}await c().fire({icon:"success",title:"Bukti DP ditolak",text:"Bukti DP ditolak, user harus melakukan reservasi ulang.",confirmButtonText:"OK"}),p(x.id,"REJECT_DP")}catch(e){console.error("Error rejecting DP proof:",e),await c().fire({icon:"error",title:"Gagal menolak bukti",text:e instanceof Error?e.message:"Terjadi kesalahan saat menolak bukti DP.",confirmButtonText:"OK"})}finally{E(!1)}},handleStatusUpdate=async e=>{v(!0);try{await p(x.id,e,"Diubah oleh admin")}catch(e){console.error("Error updating payment status:",e)}finally{v(!1)}},q=null!==(t=x.total_price)&&void 0!==t?t:0,Q=null!==(r=x.payment_amount)&&void 0!==r?r:0,X="DP"===x.payment_type&&"DP_PAID"===x.payment_status?x.payment_validated_admin:null,$="DP"===x.payment_type&&"DP_PAID"===x.payment_status?x.payment_validated_at:null,ee=null!==(o=x.dp_validated_admin)&&void 0!==o?o:X,ea=null!==(d=x.dp_validated_at)&&void 0!==d?d:$,et="DP"===x.payment_type?"PAID"===x.payment_status?x.payment_validated_admin:null:x.payment_validated_admin,es="DP"===x.payment_type?"PAID"===x.payment_status?x.payment_validated_at:null:x.payment_validated_at,en=null!==(m=x.pelunasan_validated_admin)&&void 0!==m?m:et,er=null!==(u=x.pelunasan_validated_at)&&void 0!==u?u:es,renderValidatorRow=(e,a,t)=>{let n=t?"".concat(new Date(t).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"})," • ").concat(new Date(t).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})):null;return(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("span",{className:"text-xs text-gray-600 pt-0.5",children:e}),(null==a?void 0:a.name)?(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("span",{className:"block text-xs font-medium text-gray-900",children:a.name}),n&&(0,s.jsx)("span",{className:"block text-[10px] text-gray-500",children:n})]}):(0,s.jsx)("span",{className:"text-xs font-medium text-gray-900",children:"Belum divalidasi"})]})};return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Status Pembayaran:"}),(0,s.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"PAID":return"bg-green-100 text-green-800";case"PENDING":return"bg-yellow-100 text-yellow-800";case"FULL_SENT":case"DP_PAID":return"bg-blue-100 text-blue-800";case"FULL_REJECTED":case"REFUNDED":return"bg-red-100 text-red-800";case"PELUNASAN_SENT":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}})(x.payment_status)),children:(e=>{switch(e){case"PAID":return"Lunas";case"PENDING":return"Menunggu";case"FULL_SENT":return"Bukti Lunas Terkirim";case"FULL_REJECTED":return"Ditolak Admin";case"DP_PAID":return"DP Terbayar";case"PELUNASAN_SENT":return"Pelunasan Terkirim";case"REFUNDED":return"Cancelled";default:return e}})(x.payment_status)})]})}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Tipe Pembayaran:"}),(0,s.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold ".concat("DP"===x.payment_type?"bg-blue-100 text-blue-800 border border-blue-300":"bg-green-100 text-green-800 border border-green-300"),children:"DP"===x.payment_type?"DP":"Lunas"})]}),"DP"===x.payment_type?(0,s.jsxs)("div",{className:"space-y-2",children:[renderValidatorRow("Validasi DP:",ee,ea),renderValidatorRow("Validasi Pelunasan:",en,er)]}):renderValidatorRow("Validasi Pembayaran:",en,er),(0,s.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Total Harga:"}),(0,s.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["Rp ",q.toLocaleString("id-ID")]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Jumlah Pembayaran:"}),(0,s.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["Rp ",Q.toLocaleString("id-ID")]})]}),"DP"===x.payment_type&&(0,s.jsxs)("div",{className:"flex justify-between items-center mt-2 pt-2 border-t border-blue-200",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Sisa Pembayaran:"}),(0,s.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["Rp ",(q-Q).toLocaleString("id-ID")]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Bukti Pembayaran:"}),"DP"===x.payment_type?(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("button",{onClick:()=>handleViewProof("dp"),disabled:!j,className:j?G:O,title:j?"Klik untuk melihat bukti DP":"Bukti DP belum tersedia",children:[(0,s.jsx)(i.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Bukti DP"})]}),(0,s.jsxs)("button",{onClick:()=>handleViewProof("pelunasan"),disabled:!N,className:N?"flex items-center justify-center space-x-2 px-3 h-10 rounded-md text-sm font-medium bg-purple-600 text-white hover:bg-purple-700 w-full":O,title:N?"Klik untuk melihat bukti pelunasan":"Bukti pelunasan belum tersedia",children:[(0,s.jsx)(i.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Bukti Pelunasan"})]})]}):(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("button",{onClick:()=>handleViewProof("full"),disabled:!k,className:k?G:O,title:k?"Klik untuk melihat bukti pembayaran":"Bukti pembayaran belum tersedia",children:[(0,s.jsx)(i.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Bukti Pembayaran"})]}),(0,s.jsx)("div",{})]}),"DP"===x.payment_type&&!j&&!N&&(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Belum ada bukti pembayaran yang diunggah."})]}),W&&(0,s.jsx)("div",{className:"text-xs text-yellow-700 bg-yellow-50 border border-yellow-200 rounded-md px-3 py-2",children:"Lihat bukti terkait terlebih dahulu sebelum melakukan verifikasi atau pembatalan."}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 items-stretch",children:[(0,s.jsx)("button",{onClick:()=>handleStatusUpdate("DP_PAID"),disabled:D||h||"DP"!==x.payment_type||"PENDING"!==x.payment_status||g.includes("pelunasan")||j&&!B,className:"".concat(K," bg-blue-600 text-white hover:bg-blue-700 w-full")+(D||h||"DP"!==x.payment_type||"PENDING"!==x.payment_status||g.includes("pelunasan")||j&&!B?" opacity-50 cursor-not-allowed":""),children:(0,s.jsx)("span",{children:"Verifikasi DP"})}),(0,s.jsx)("button",{onClick:handleRejectDp,disabled:w||h||"DP"!==x.payment_type||"PENDING"!==x.payment_status||j&&!B,className:V+(w||h||"DP"!==x.payment_type||"PENDING"!==x.payment_status||j&&!B?" opacity-50 cursor-not-allowed":""),children:(0,s.jsx)("span",{children:w?"Memproses...":"Tolak Bukti DP"})}),(0,s.jsx)("button",{onClick:()=>handleStatusUpdate("PAID"),disabled:D||h||"PAID"===x.payment_status||"PELUNASAN_PAID"===x.payment_status||"DP"===x.payment_type&&(!M||!N)||"DP"===x.payment_type&&N&&!I||!J&&k&&!R,className:"".concat(K," bg-green-600 text-white hover:bg-green-700 w-full")+(!D&&!h&&"PAID"!==x.payment_status&&"PELUNASAN_PAID"!==x.payment_status&&("DP"!==x.payment_type||M&&N)&&("DP"!==x.payment_type||!N||I)&&(J||!k||R)?"":" opacity-50 cursor-not-allowed"),children:(0,s.jsx)("span",{children:"DP"===x.payment_type?"Verifikasi Pelunasan":"Verifikasi Lunas"})}),(0,s.jsx)("button",{onClick:handleRejectPelunasan,disabled:P||h||"PAID"===x.payment_status||"PELUNASAN_PAID"===x.payment_status||"DP"===x.payment_type&&(!N||N&&!I)||"FULL"===x.payment_type&&(!k||k&&!R),className:V+(P||h||"PAID"===x.payment_status||"PELUNASAN_PAID"===x.payment_status||"DP"===x.payment_type&&(!N||N&&!I)||"FULL"===x.payment_type&&(!k||k&&!R)?" opacity-50 cursor-not-allowed":""),children:(0,s.jsx)("span",{children:P?"Memproses...":"DP"===x.payment_type?"Tolak Bukti Pelunasan":"Tolak Bukti Pembayaran"})}),(0,s.jsx)("div",{className:"col-span-2 flex justify-center",children:(0,s.jsx)("button",{onClick:()=>handleStatusUpdate("REFUNDED"),disabled:D||h,className:"".concat(K," bg-gray-600 text-white hover:bg-gray-700 w-1/2")+(D||h?" opacity-50 cursor-not-allowed":""),children:(0,s.jsx)("span",{children:"Cancel Pembayaran"})})})]}),"PAID"===x.payment_status&&(0,s.jsxs)("div",{className:"text-sm text-green-700 bg-green-50 border border-green-200 rounded-md px-3 py-2 flex items-center space-x-2",children:[(0,s.jsx)("span",{children:"✅"}),(0,s.jsx)("span",{className:"font-medium",children:"Pembayaran sudah lunas dan terverifikasi"})]}),h&&(0,s.jsxs)("div",{className:"text-sm text-gray-700 bg-gray-50 border border-gray-200 rounded-md px-3 py-2 flex items-center space-x-2",children:[(0,s.jsx)("span",{children:"\uD83D\uDEAB"}),(0,s.jsx)("span",{className:"font-medium",children:"CANCELLED"===x.status?"Booking sudah dibatalkan - tidak dapat melakukan validasi":"Booking sudah ditolak - tidak dapat melakukan validasi"})]})]}),T&&Z&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl max-h-[90vh] overflow-hidden shadow-lg",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"pelunasan"===L?"Bukti Pelunasan":"dp"===L?"Bukti Pembayaran DP":"Bukti Pembayaran"}),"pelunasan"===L&&x.pelunasan_sender_account_name&&(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Nama Rekening: ",(0,s.jsx)("span",{className:"font-semibold text-gray-900",children:x.pelunasan_sender_account_name})]}),("dp"===L||"full"===L)&&x.dp_sender_account_name&&(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Nama Rekening: ",(0,s.jsx)("span",{className:"font-semibold text-gray-900",children:x.dp_sender_account_name})]})]}),(0,s.jsx)("button",{onClick:()=>A(!1),className:"text-gray-400 hover:text-gray-600",children:(0,s.jsx)(n.Z,{className:"w-6 h-6"})})]}),(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)("img",{src:Z,alt:"pelunasan"===L?"Bukti Pelunasan":"Bukti Pembayaran",className:"max-w-full max-h-[70vh] object-contain mx-auto"})}),(0,s.jsx)("div",{className:"flex justify-end space-x-2 p-4 border-t",children:(0,s.jsx)("button",{onClick:()=>A(!1),className:"px-3 py-2 bg-gray-100 text-gray-700 rounded-md text-sm hover:bg-gray-200",children:"Tutup"})})]})})]})}function BookingDetailModal(e){let{reservation:a,isOpen:t,onClose:l,onPaymentStatusUpdate:i,onDelete:o}=e,handleClose=()=>{l()},handleDelete=async()=>{let e=await c().fire({title:"Hapus Reservasi?",html:'\n        <div class="text-left">\n          <p class="text-gray-700 mb-2">Apakah Anda yakin ingin menghapus reservasi ini?</p>\n          <div class="bg-red-50 border border-red-200 rounded-lg p-3 mt-3">\n            <p class="text-sm text-red-800"><strong>Perhatian:</strong> Data reservasi akan dihapus permanen dan tidak dapat dikembalikan.</p>\n          </div>\n          <div class="mt-3 text-sm text-gray-600">\n            <p><strong>Customer:</strong> '.concat(a.user.name,"</p>\n            <p><strong>Lapangan:</strong> ").concat(a.field_name,"</p>\n            <p><strong>Tanggal:</strong> ").concat(new Date(a.reservation_date).toLocaleDateString("id-ID"),"</p>\n          </div>\n        </div>\n      "),icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal",reverseButtons:!0});if(e.isConfirmed)try{let e=localStorage.getItem("token");if(!e){c().fire({icon:"error",title:"Gagal",text:"Token tidak ditemukan. Silakan login kembali.",confirmButtonColor:"#2563eb"});return}let t=await fetch("/api/reservations/".concat(a.id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();if(t.ok)await c().fire({icon:"success",title:"Berhasil!",text:"Reservasi berhasil dihapus",confirmButtonColor:"#2563eb",timer:2e3}),l(),o&&o();else throw Error(s.error||"Gagal menghapus reservasi")}catch(e){console.error("Error deleting reservation:",e),c().fire({icon:"error",title:"Gagal",text:e.message||"Terjadi kesalahan saat menghapus reservasi",confirmButtonColor:"#ef4444"})}};if(!t)return null;let d=(e=>{switch(e){case"PENDING":return{color:"bg-yellow-100 text-yellow-800",text:"Menunggu"};case"DP_SENT":return{color:"bg-blue-100 text-blue-800",text:"DP Terkirim"};case"DP_PAID":return{color:"bg-blue-200 text-blue-900",text:"DP Terbayar"};case"DP_REJECTED":return{color:"bg-red-100 text-red-800",text:"DP Ditolak"};case"PELUNASAN_SENT":return{color:"bg-purple-100 text-purple-800",text:"Pelunasan Terkirim"};case"PELUNASAN_REJECTED":return{color:"bg-red-100 text-red-800",text:"Pelunasan Ditolak"};case"PELUNASAN_PAID":return{color:"bg-purple-200 text-purple-900",text:"Pelunasan Terbayar"};case"REJECTED":return{color:"bg-red-100 text-red-800",text:"Ditolak Admin"};case"CANCELLED":return{color:"bg-orange-100 text-orange-800",text:"Dibatalkan"};case"COMPLETED":return{color:"bg-green-100 text-green-800",text:"Selesai"};default:return{color:"bg-gray-100 text-gray-800",text:e}}})(a.status),m=(e=>{switch(e){case"PENDING":return{color:"bg-yellow-100 text-yellow-800",text:"Menunggu"};case"FULL_SENT":return{color:"bg-blue-100 text-blue-800",text:"Bukti Lunas Terkirim"};case"FULL_REJECTED":return{color:"bg-red-100 text-red-800",text:"Ditolak Admin"};case"DP_SENT":return{color:"bg-blue-100 text-blue-800",text:"DP Terkirim"};case"DP_PAID":return{color:"bg-blue-200 text-blue-900",text:"DP Terbayar"};case"DP_REJECTED":return{color:"bg-red-100 text-red-800",text:"DP Ditolak"};case"PELUNASAN_SENT":return{color:"bg-purple-100 text-purple-800",text:"Pelunasan Terkirim"};case"PELUNASAN_PAID":return{color:"bg-purple-200 text-purple-900",text:"Pelunasan Terbayar"};case"PAID":return{color:"bg-green-100 text-green-800",text:"Lunas"};case"REFUNDED":return{color:"bg-red-100 text-red-800",text:"Dikembalikan"};default:return{color:"bg-gray-100 text-gray-800",text:e}}})(a.payment_status);return a.payment_validated_at&&new Date(a.payment_validated_at).toLocaleString("id-ID"),(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-gray-200 flex-shrink-0",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Detail Booking"}),(0,s.jsx)("button",{onClick:handleClose,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,s.jsx)(n.Z,{className:"w-6 h-6"})})]}),(0,s.jsx)("div",{className:"p-6 overflow-y-auto flex-1",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-3",children:"Informasi Lapangan"}),(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Nama Lapangan:"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900",children:a.field_name})]})})]}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-3",children:"Informasi Customer"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Nama:"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900",children:a.user.name})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Email:"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900",children:a.user.email})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Telepon:"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900",children:a.user.phone||"Tidak ada"})]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-3",children:"Detail Reservasi"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Tanggal:"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900",children:new Date(a.reservation_date).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Waktu:"}),(0,s.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:[a.start_time," - ",a.end_time]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Tipe Pembayaran:"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"DP"===a.payment_type?"DP":"Lunas"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Total Harga:"}),(0,s.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["Rp ",a.total_price.toLocaleString("id-ID")]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Pembayaran:"}),(0,s.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["Rp ",(a.payment_amount||a.total_price).toLocaleString("id-ID")]})]}),"DP"===a.payment_type&&(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Sisa Pembayaran:"}),(0,s.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["Rp ",(a.total_price-(a.payment_amount||0)).toLocaleString("id-ID")]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Status:"}),(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(d.color),children:d.text})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Status Pembayaran:"}),(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(m.color),children:m.text})]})]})]}),a.notes&&(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-3",children:"Catatan"}),(0,s.jsx)("p",{className:"text-sm text-gray-700",children:a.notes})]})]}),(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Validasi Pembayaran"}),(0,s.jsx)(PaymentValidation,{reservation:a,onStatusUpdate:i})]})})]})}),(0,s.jsxs)("div",{className:"flex justify-between items-center p-6 border-t border-gray-200 flex-shrink-0 bg-gray-50",children:[(0,s.jsxs)("button",{onClick:handleDelete,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors shadow-sm",children:[(0,s.jsx)(r.Z,{className:"w-4 h-4 mr-2"}),"Hapus Reservasi"]}),(0,s.jsx)("button",{onClick:handleClose,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors shadow-sm",children:"Tutup"})]})]})})}},636:function(e,a,t){t.d(a,{Z:function(){return AdminHeader}});var s=t(7437),n=t(2265),r=t(8004),l=t(8203),i=t(6141);function AdminHeader(e){let{title:a,onMenuClick:t}=e,[o,c]=(0,n.useState)(""),[d,m]=(0,n.useState)(new Date);(0,n.useEffect)(()=>{let e=setInterval(()=>{m(new Date)},1e3);return()=>clearInterval(e)},[]);let formatTime=e=>e.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",second:"2-digit"});return(0,s.jsxs)("div",{className:"bg-white shadow-sm border-b border-gray-200 h-16 flex items-center justify-between px-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>{console.log("Hamburger button clicked"),null==t||t()},className:"lg:hidden p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:(0,s.jsx)(r.Z,{className:"w-6 h-6"})}),(0,s.jsx)("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:a})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"hidden md:flex items-center space-x-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 bg-blue-50 text-blue-700 px-3 py-1.5 rounded-lg border border-blue-200",children:[(0,s.jsx)(l.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"font-medium text-sm",children:d.toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 bg-purple-50 text-purple-700 px-3 py-1.5 rounded-lg border border-purple-200",children:[(0,s.jsx)(i.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"font-mono font-semibold text-sm tabular-nums",children:formatTime(d)})]})]}),(0,s.jsxs)("div",{className:"md:hidden flex items-center space-x-2 bg-purple-50 text-purple-700 px-3 py-1.5 rounded-lg border border-purple-200",children:[(0,s.jsx)(i.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"font-mono font-semibold text-sm tabular-nums",children:formatTime(d)})]})]})]})}},9250:function(e,a,t){t.d(a,{Z:function(){return AdminSidebar}});var s=t(7437),n=t(1396),r=t.n(n),l=t(4033),i=t(6820),o=t.n(i),c=t(5119),d=t(8203),m=t(6142),u=t(9183),x=t(5750),p=t(2549),g=t(5883);function AdminSidebar(e){let{isOpen:a,setIsOpen:t}=e,n=(0,l.usePathname)(),i=[{name:"Dashboard",href:"/admin",icon:c.Z},{name:"Booking",href:"/admin/booking",icon:d.Z},{name:"Lapangan",href:"/admin/fields",icon:m.Z},{name:"Member",href:"/admin/members",icon:u.Z},{name:"Pengguna",href:"/admin/users",icon:x.Z}],handleLogout=async()=>{try{let e=localStorage.getItem("token");if(e){console.log("\uD83D\uDD13 [Admin] Calling logout API...");let a=await fetch("/api/auth/logout",{method:"POST",headers:{Authorization:"Bearer ".concat(e)}}),t=await a.json();console.log("\uD83D\uDCE1 [Admin] Logout API response:",a.status,t)}localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("unpaidReservations"),await o().fire({icon:"success",title:"Berhasil Keluar",text:"Anda telah berhasil keluar dari panel admin.",confirmButtonColor:"#16a34a",confirmButtonText:"OK"}),window.location.replace("/")}catch(e){console.error("❌ [Admin] Error during logout:",e),localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("unpaidReservations"),await o().fire({icon:"warning",title:"Keluar Berhasil",text:"Anda telah keluar dari panel admin.",confirmButtonColor:"#16a34a",confirmButtonText:"OK"}),window.location.replace("/")}};return(0,s.jsxs)(s.Fragment,{children:[a&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>t(!1)}),(0,s.jsxs)("div",{className:"w-64 bg-white shadow-lg h-screen fixed left-0 top-0 z-50 transform transition-transform duration-300 ease-in-out ".concat(a?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:[(0,s.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-green-600 rounded-lg flex items-center justify-center",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"20",height:"20",fill:"white",children:[(0,s.jsx)("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492M5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0"}),(0,s.jsx)("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115z"})]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"GOR Puri Beta"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Admin Reservation"})]})]}),(0,s.jsx)("button",{onClick:()=>t(!1),className:"lg:hidden p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:(0,s.jsx)(p.Z,{className:"w-5 h-5"})})]})}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Menu Utama"}),(0,s.jsx)("nav",{className:"space-y-2",children:i.map(e=>{let a=e.icon,l=n===e.href;return(0,s.jsxs)(r(),{href:e.href,onClick:()=>t(!1),className:"flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors ".concat(l?"bg-gray-100 text-gray-900":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"),children:[(0,s.jsx)(a,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"font-medium",children:e.name})]},e.name)})})]}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-gray-200",children:(0,s.jsxs)("button",{onClick:handleLogout,className:"flex items-center space-x-3 px-3 py-2 text-gray-700 hover:bg-gray-50 hover:text-gray-900 rounded-lg transition-colors w-full",children:[(0,s.jsx)(g.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"font-medium",children:"Keluar"})]})})]})]})}}}]);